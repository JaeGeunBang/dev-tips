**S3 셋팅**



**S3만들기**

https://s3.console.aws.amazon.com/s3/home?region=ap-northeast-2#



**버킷 만들기**

- 버킷 이름
  - 버킷 이름은 global 유니크한 값이여야 한다. 즉, 내 계정 뿐 아니라 전세계 S3 사용자들 중 butket 명은 유일해야 한다.
- 리전



**특징**

- S3는 Flat한 구조이다.
  - 일반 파일 시스템은 계층적인 구조이며, `touch dir1/text.txt`를 수행하면 dir1 디렉토리가 없기 때문에 동작하지 않는다.
    - 그렇기 때문에 dir1 디렉토리를 먼저 만든 이후 진행해야한다.
  - 하지만, S3는 파일 시스템이 아닌 동일 경로에 모두 저장되어 있다. `dir1/text.txt`랑 `text.txt` 랑 같은 경로에 있음.



**S3 권한**

- 먼저 권한 창에 들어가 모든 사용자에 대해 권한을 줄 수 있다. 권한 부여 방법은 ACL, 버킷 정책이 있다.
  - ACL 권한은 사용자 id나 이메일 정보를 등록해야한다.
- 허나, 그렇게 하지 않고 버킷 정책을 통해 권한을 부여한다.
  - json을 통해 세세하게 버킷에 대한 권한을 줄 수 있다. 

![스크린샷 2019-12-15 오후 1.22.05](/Users/bangjaegeun/Desktop/스크린샷 2019-12-15 오후 1.22.05.png)

- 위 그림처럼 위 `ACL 권한`은 차단하고 밑에 `버킷 정책`은 허용한다.
- 이후 버킷 정책 - 정책 생성기에 들어가 정책을 생성한다. 이후 아래 json을 복사한다

```
{
  "Id": "Policy----------",
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "Stmt-------",
      "Action": [
        "s3:GetObject"
      ],
      "Effect": "Allow",
      "Resource": "-------/*",
      "Principal": "*"
    }
  ]
}
```

- 모든 유저에게 (Pricipal) Resource 권한 (Resource, ARN)을 모두 주겠다는 의미.



**정적 웹 호스팅 방법**

- S3 속성에 들어가 정적 웹 사이트 호스팅에 들어간다.
- 웹 사이트 호스팅을 체크하고, 복사한 index.html을 입력하고 위에 엔드포인트를 클릭한다.

![스크린샷 2019-12-15 오후 1.31.43](/Users/bangjaegeun/Desktop/스크린샷 2019-12-15 오후 1.31.43.png)



**버전 기능 관리**

- S3에 파일이 삭제될 경우가 있을 수 있고, 파일의 버전 관리를 위해 사용한다.
- 속성 - 버전 관리에서 버전관리 기능을 활성화 한다.
- 이후 버전 - 표시를 하면 각 파일의 버전이 관리되는 것을 볼 수 있다.



**서버 액세스 로깅 기능**

- S3 접근에 대한 트래픽에 대한 로깅을 할 수 있다.



**객체 수준 로깅 기능**

- 객체 단위의 로깅이 가능하다.



**전송 속도 향상**

- 객체에 접속할 수 있는 속도를 높일 수 있다. 하지만 그만큼의 비용이 추가로 든다.



**이벤트**

- 버킷에 특정 이벤트가 발생할 경우 알람을 받을 수 있다. 람다 함수를 만들어 사용할 수 있음.



**요청자 지불**

- 버킷을 담당하는 사용자가 비용을 지불해야한다.
- 하지만, ACL 에서 유저를 추가할 수 있는데 특정 요청자에게 버킷의 객체를 사용한 요금을 지불하게 할 수 있다.







